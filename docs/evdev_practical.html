<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>11&nbsp; Modeling Thermomorphogenesis in Plants – Modeling Life</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./evo_intro_text.html" rel="next">
<link href="./evdev_intro_text.html" rel="prev">
<link href="./images/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./evdev_intro_text.html">IV) Environment</a></li><li class="breadcrumb-item"><a href="./evdev_practical.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modeling Thermomorphogenesis in Plants</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/android-chrome-512x512.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modelling life</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Course information</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling life</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General course info</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Slides</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_to_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">0) Introduction to Python</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">I) Pattern formation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pattern_intro_text.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Pattern formation (intro)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pattern_practical_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Gradients and segments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pattern_practical_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Turing digit patterns</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pattern_practical_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Clock-and-wavefront patterning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">II) Morphogenesis</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./morpho_intro_text.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">What is morphogenesis?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./morpho_cpm_practical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Erika CPM practical</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">III) Cell differentiation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./differentiation_intro_text.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Differentiation introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./differentiation_practical_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Gene regulation in time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./differentiation_practical_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Gene regulation in space</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">IV) Environment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./evdev_intro_text.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Environmental inputs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./evdev_practical.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modeling Thermomorphogenesis in Plants</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">V) Evolution</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./evo_intro_text.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to evolution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./evo_practical_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Sticking together</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./evo_practical_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">What gets selected?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./evo_practical_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Public goods</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Mini-projects</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Miniproject: Pattern formation in vegetation in semi-arid areas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Miniproject: maintaining a healthy microbiome</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Miniproject: The devil is in the details – auxin transport in the root</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Miniproject: Patterning – Asymmetric localization of ZIF-1 in the C. elegans embryo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Miniproject: Oncogenic propensity of different stem cell niches</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#the-model" id="toc-the-model" class="nav-link active" data-scroll-target="#the-model"><span class="header-section-number">11.1</span> The model</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">11.2</span> Exercises</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">11.3</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./evdev_intro_text.html">IV) Environment</a></li><li class="breadcrumb-item"><a href="./evdev_practical.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modeling Thermomorphogenesis in Plants</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modeling Thermomorphogenesis in Plants</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Plants respond to temperature not only through metabolic changes but also by adjusting their morphology. A well known response of plants to increased ambiant temperature is the lifiting of their leaves (hyponasty) and increasing their petiole (stalk between leaf and stem) length to lower the internal leaf temperature. It is thought that this may help plants cope with heat, but it’s not always clear whether and if so how this actually improves growth. In this practical, we will use and extend a small ODE model of carbon (C) and leaf area (LA) dynamics and explore how temperature and thermomorphogenic responses affect growth. You’ll simulate different temperature conditions and analyze how traits like leaf angle and size affect photosynthesis and carbon respiration rate, and how this affects overall plant growth. Later, you will investigate the adaptive value of this response, as this is still an open question.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/practical7.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Fig 1. Taken from Quint et al., Nat. Plants 2016; Taken from Bridge et al., Interface 2013."><img src="images/practical7.png" class="img-fluid figure-img" alt="Fig 1. Taken from Quint et al., Nat. Plants 2016; Taken from Bridge et al., Interface 2013."></a></p>
<figcaption>Fig 1. Taken from Quint et al., Nat. Plants 2016; Taken from Bridge et al., Interface 2013.</figcaption>
</figure>
</div>
<section id="the-model" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="the-model"><span class="header-section-number">11.1</span> The model</h2>
<p>In <code>code 00_Environment_and_development.py</code> we start with a simple two ODE model where leaf area (<span class="math inline">\(L\)</span>) grows with rate <span class="math inline">\(G\)</span>, which depends on carbon concentration (<span class="math inline">\(C_c\)</span>) and leaf area. Carbon (<span class="math inline">\(C\)</span>) is produced by photosynthesis (<span class="math inline">\(P\)</span>) dependent on leaf area, leaf angle (<span class="math inline">\(\alpha\)</span>), and temperature (<span class="math inline">\(T\)</span>). Carbon is consumed by growth and respiration (<span class="math inline">\(R\)</span>), dependent on temperature and leaf area again:</p>
<p><span class="math inline">\(\frac{dC}{dt}=P(L,T,\alpha)-R(L,T)-G(C_c,L)\)</span></p>
<p><span class="math inline">\(\frac{dL}{dt}=G(C_c,L)\)</span></p>
<section id="photosynthesis" class="level3">
<h3 class="anchored" data-anchor-id="photosynthesis">Photosynthesis</h3>
<p>Photosynthesis is a complex process that can be modeled in many different ways with varying complexity. Here, in the function <code>Photosynthesis_per_m2()</code> we included a semi-detailed photosynthesis model based on the assumption that the protein RubisCo is the limiting step in photosynthesis. This model has 6 parameters and 2 environmental variables, of which all parameters are temperature sensitive. This temperature sensitivity is based on the Arrhenius equation, which describes the temperature dependency of chemical reaction rates.</p>
</section>
<section id="maintenance-respiration" class="level3">
<h3 class="anchored" data-anchor-id="maintenance-respiration">Maintenance Respiration</h3>
<p>Maintenance respiration is a term used in biological systems to describe all energy/carbon consuming processes that a plant must do to survive. Similar to photosynthesis, the rates of these reactions increase with temperature, and as such, carbon costs greatly increase. We model this in the function Respiration_per_m2() using the Q10 equation, that describes how much a rate increases for 10 degrees of temperature increase.</p>
</section>
</section>
<section id="exercises" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="exercises"><span class="header-section-number">11.2</span> Exercises</h2>
<div id="exr-test" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 11.1 (Algorithmic thinking and Biology - Temperature Effects on Photosynthesis, Respiration and Growth)</strong></span> Let us first investigate how photosynthesis and respiration depend on temperature.</p>
<ol type="a">
<li><p>Plot photosynthesis and respiration rate as a function of temperature, using the functions defined above. Explain: What happens to net carbon gain at high temperature? Why is high temperature problematic for growth in this model?</p></li>
<li><p>Run the code and study the output for leaf area and carbon. Why does leaf area increase exponentially while carbon levels saturate? What carbon level are you actually plotting?</p></li>
<li><p>Now run simulations of the ODE model for low (15°C), medium (25°C), and high (35°C)<br>
temperatures. Which plant performs best? Which plant worst? Why is this?</p></li>
</ol>
</div>
<blockquote class="blockquote">
<p><strong>Answer</strong></p>
<ol type="a">
<li><p>See answer code ‘01_Environment_and_development_answer.py’ You need to do this plotting outside of the plant growth simulation loop by calling the photosynthesis and respiration functions for a range of temperatures (10-40 degrees).</p></li>
<li><p><span class="math inline">\(dLA/dt=Gmax*(C*/(C*+K))*LA\)</span></p></li>
</ol>
<p>This gives <span class="math inline">\(LA(t)=LA(0)*exp(Gmax*(C/(C+K))*t)\)</span></p>
<p>In contrast:</p>
<p><span class="math inline">\(dC/dt=photosynthesis-respiration-growth\)</span></p>
<p><span class="math inline">\(dC/dt=p*LA-d*LA- Gmax*(C*/(C*+K))*LA\)</span></p>
<p>Solving <span class="math inline">\(dC/dt=0\)</span> we get <span class="math inline">\(LA=0\)</span> (no plant) or</p>
<p><span class="math inline">\(p-d-Gmax*(C*/(C*+K))=0\)</span></p>
<p><span class="math inline">\(p-d=Gmax*(C*/(C*+K))\)</span></p>
<p><span class="math inline">\((p-d)*C*+(p-d)*K=Gmax*C*\)</span></p>
<p><span class="math inline">\((p-d)*K=(Gmax-p+d)*C*\)</span></p>
<p><span class="math inline">\(C*=(p-d)*K/(Gmax-p+d)\)</span></p>
<p><span class="math inline">\(C*=C/LA\)</span></p>
<p>So carbon concentration equilibrates, not total carbon</p>
<ol start="3" type="a">
<li>See answer <code>code 01_Environment_and_development_answer.py</code> for running and plotting the 3 different temperatures. At 15 degrees respiration is low but photosynthesis is far below optimal, so at 25 degrees you loose more to respiration but that is overcompensated by the increase in photosynthesis, at 35 degrees photosynthesis is beyond its optimum while respiration is now very high; as a consequence 25 degrees gives optimum growth and 35 the worst.</li>
</ol>
</blockquote>
<div id="exr-test" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 11.2 (Mathematical &amp; Biological thinking - Hyponasty – Leaf angle increase)</strong></span> Until now we have investigated the effect of temperature on plants that do not respond to their environment, but plants do respond to their surroundings.Plants display a variety of responses to elevated temperature, and one of these is so-called leaf hyponasty in which leaves are positioned in a more upward orientation that is often accompanied by longer leaf stems (petioles) and smaller leaves (blades). Let us extend the model to first simply include the orientation aspect of this hyponastic response to high temperature.</p>
<ol type="a">
<li>The photosynthesis function already includes a term for ‘effective leaf area (LA_eff)’, but the function does currently return the total leaf area. Rewrite this function to return effective leaf area as a function of leaf elevation angle, assuming that light comes from above. Plot the effective leaf area as a function of angle. How does hyponasty affect photosynthesis? What other factors could affect effective leaf area?</li>
<li>Now investigate the effect of the increased leaf angle on plant growth. Compare medium (25°C) and high temperature (35°C) for normal (20°) and increased (40°) angle.</li>
</ol>
</div>
<blockquote class="blockquote">
<p><strong>Answer</strong></p>
<ol type="a">
<li><p>See answer code ‘02_Environment_and_development_answer.py’ Under the assumption that light comes from above it holds that effective leaf area=the area projected on the horizontal surface which can be found by taking the cosine of the angle of the leaf. So the larger the angle the smaller the effective leaf area. This results in an effective reduction of leaf area and thus photosynthesis. Shading, chloroplast density, leaf size could all affect effective leaf area.</p></li>
<li><p>As can be expected from the above, the temperature increase combined with the angle increase now both reduce photosynthesis and hence carbon and leaf area increase, so it is basically adding insult to injury rather than helping.</p></li>
</ol>
</blockquote>
<div id="exr-test" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 11.3 (Biology - Hyponasty– Cooling Benefit)</strong></span> Leaf hyponasty is shown to lower leaf temperature with a few degrees by improving heat dissipation and decreasing the area in which direct sunlight hits the leaves.</p>
<ol type="a">
<li><p>Investigate the effect of the leaf cooling. How much cooling is needed for hyponasty to have a net positive effect? Simply assume a certain cooling effect and hence apply a lower temperature than the environmental one.</p></li>
<li><p>Hyponasty is shown to lower leaf temperature by only 1-2°C (see the left picture at the beginning of this document), what is the effect of this amount of cooling on plant growth? Would you argue that this hyponastic response is adaptive in the current model (i.e.&nbsp;assuming no other factors play a role)?</p></li>
<li><p>Reanalyze the curves describing how photosynthesis rate depends on temperature and how effective leaf area depends on angle and explain your earlier results.</p></li>
</ol>
</div>
<blockquote class="blockquote">
<p><strong>Answer</strong></p>
<ol type="a">
<li><p>See answer code ‘03_Environment_and_development_answer.py’ If the 40 degree angle results in slightly more than 3 degrees of cooling, causing internal leaf temperature to be less then 32 degrees instead of the external 35 degrees, final leaf area is larger than for 35 degrees and an angle of 20 degrees. Note that if under high temperature leaf anlge would increase to only 35 degrees, a slightly less than 3 degrees of cooling would already have a positive effect and this positive effect would start already at 32.5 degrees celcius.</p></li>
<li><p>See answer code <code>03_Environment_and_development_answer.py</code> No for only 1-2 degrees of cooling final leaf area is smaller under a hyponastic response than if leaf angle were kept at 20 degrees under 35 degrees celcius temperature.</p></li>
<li><p>Photosynthesis is normalized to 100% at 25 degrees and is 90% at 35 degrees. Lowering leaf temperature with 1-2 degrees by hyponasty recovers this to 95 % while lowering it to 2-3 degrees recovers it to 100%. Still since there is only a 10% loss of photosynthesis to high temperature there is also only a max 10% gain by cooling the leaves. At the same time a hyponastic angle of 40% decreases effective leaf area to 80 percent whereas it is 95% for 20 degrees. So the loss is 15%, which is more than the potential gain.</p></li>
</ol>
</blockquote>
<div id="exr-test" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 11.4 (Biology -Is hyponasty adaptive?)</strong></span> The cooling down of the leaves through hyponasty is thought to be an important adaptive trait. Interestingly, from the simulations we’ve done so far this adaptive advantage is not very clear. It might therefore very well be that we miss important processes in the current model. In this last question of the practical you will extend the model with additional processes also relevant in plants to see if this may help explain the adaptiveness of hyponasty. This is also an open question in current research, so there is no clear answer and you might actually come up with novel ideas! To help guide your thinking, we have come up with some additional plant processes you can implement and investigate to see how these impact adaptiveness of leaf hyponasty under high temperature. Pick one to work on and investigate if this would render hyponasty more clearly adaptive. If you have extra time, see if you can combinethem. If you have other ideas to work on, this is also great!</p>
<ol type="a">
<li><em>Hypothesis 1 - Day-Night Rhythm </em></li>
</ol>
<p>We found that during the day, while hyponastic cooling brings photosynthesis closer to its optimum temperature and reduces respiration, this is insufficient to overcompensate the costs of reduced effective leaf area. During the night, cooler leaf temperatures still reduce maintenance respiration, while photosynthesis halts and hence reduction of effective leaf area plays no role, suggesting at night time hyponasty has only advantages. To investigate whether this results in a net adaptive effect of leaf hyponasty incorporate the following processes in your model: - Temperature: Simulate the cooling effect of nighttime. - Photosynthesis: Photosynthesis does not occur without sunlight, so simulate the change of light over the day and its effects. - Respiration: Maintenance respiration persists in absence of photosynthesis. - Hyponasty changes: Leaf angles change over the course of a day, reaching a minimum early during the day and being relatively high during the night. - Growth rate: Counterintuitively in plants often most growth happens during the night, when water loss is minimal and hence turgor pressure is high.</p>
<p>Hint: use sinus functions to describe the daily rhythms and their relative phases. Make sure that light is really zero at night.</p>
<p><strong>a1.</strong> Analyze how the absence of photosynthesis at night affects carbon balance. Do you think what you see happening is reasonable? How could you repair this?</p>
<p><strong>a2.</strong> Examine the impact of nighttime temperatures on maintenance respiration rates.</p>
<p><strong>a3.</strong> Explore how changes in leaf angle influence overall plant growth.</p>
<p><strong>a4.</strong> Now combine the two</p>
<ol start="2" type="a">
<li><em>Hypothesis 2 – Stomata</em></li>
</ol>
<p>Stomata play a critical role in regulating gas exchange and water loss in plants. As leaf temperature increases, stomata open to enhance transpiration, which cools the leaf through evaporative cooling. This mechanism is particularly effective in well-watered plants, where increased stomatal opening can significantly reduce leaf temperature up to around a maximum of 9-10°C. However, at very high temperatures, stomata may close to prevent excessive water loss, which can lead to overheating. Additionally, stomatal opening increases while stomatal closing decreases photosynthesis rates by affecting gas exchange efficiency. Thus, incorporating this dependence of stomatal aperture on temperature may enhance the detrimental effects of high temperature, offering more opportunity for leaf cooling effects of hyponasty to matter.</p>
<p>To model this, implement the following changes: - Stomatal opening affects photosynthesis: Include in the photosynthesis function a multiplication factor for stomatal aperture. - Stomatal opening depends on temperatures: Include a function that describes how stomatal aperture first increases with temperature, reaches a maximum at around 25 degrees and then declines for higher temperatures. Aperture should be approximately half the maximum value for temperatures of 10 degrees and 35 degrees. - Stomatal opening increases transpiration: Simulate the cooling effect of transpiration on leaf temperature.</p>
<p>Analyze how stomatal opening affects leaf cooling and photosynthesis under moderate temperature conditions. Investigate the trade-offs between cooling benefits and photosynthesis efficiency at very high temperatures. Examine how stomatal closure impacts plant growth and carbon balance under heat stress.</p>
</div>
<blockquote class="blockquote">
<p><strong>Answer</strong></p>
<p><strong>a1.</strong> Carbon levels at night go below zero because while growth depends on carbon levels, respiration continues independent of carbon levels in the current model. However, you can not burn energy you do not have so it is best to make respiration also depend on carbon levels, this is constistent with experimental observations: <span class="citation" data-cites="seki2017adjustment">Seki et al. (<a href="references.html#ref-seki2017adjustment" role="doc-biblioref">2017</a>)</span></p>
<p><strong>a2.</strong> The less temperatures drop during the night, the larger the reduction in final leaf area, yet also the closer the final leaf area achieved with hyponasty becomes to that without. As night time temperature is higher, respiration is higher and leaf cooling becomes more relevant. So we increase the night time advantage of hyponasty.</p>
<p><strong>a3.</strong> For leaf angle we can play with how much the minimum and maximum angles are and when during the day these are reached. If leaf angle is allowed to drop from 40 to 14 degrees instead of 20 degrees and the lowest point is reached early in the morning, average day time angle is lower and hence photosynthesis loss is lower and hence break even is reached easier. If maximum leaf angle is lowered to 35 degrees it also helps. So here we basically decrease the day time costs of hyponasty.</p>
<p><strong>a4.</strong> If we make leaf angle during the day low and keep night time temperature high we are able to make hyponasty adaptive. The results are a bit shaky in that in the final leaf area versus temperature curve the non hyponasty and hyponasty curves intersect multiple times but beyond 32 degrees with hyponasty is always on top but with small difference.</p>
<ol start="2" type="a">
<li>See answer <code>code 04_Environment_and_development_Stomata_1.py</code> This is a first code with a Gaussian function for how stomatal aperture depends on temperature that results in stomatal opening being maximal at around 25 degrees. Now slightly less than 2 degrees cooling (on top of the stomatal aperture induced cooling) suffices to make leaf hyponasty advantageous. This is because temperature increase harms photosynthesis now way more (leaf area under no hyponasty decreases to 32 instead of 43% while with hyponasty it decreases to 20 instead of 25%, 43-25=18% 32-20=12%). But this approach is a bit odd: we let stomatal aperture affect effective leaf temperature, and separately (and before this) substract the cooling effect of hyponasty.</li>
</ol>
<p>See answer code <code>04_Environment_and_development_Stomata_2.py</code> Instead of doing a manual extra cooling because of leaf hyponastic angle here we made a function for leaf temperature that takes into account both the stomatal aperture (max cooling effect of 10 degrees for full aperture at 35 degrees) and the leaf angle (max cooling effect of 2 degrees for a 40 degree angle). Now final leaf area decreases to 34% for no hyponasty and to 25% for hyponasty so 34-25=9%. (and looking at the lower temperatures done by further manual substraction is non-sensical now). So, although difference becomes less and less, still hyponasty costs more than it delivers. Also intriguing that if we put both effects into leaf temperature directly we can not get it to work while if we put in the 2 degrees cooling from the angle manually and then the stomatal affect it could work. This is because with the 2 degrees manually, stomatal opening for 33 degrees applies which is 70% whereas without this, stomatal opening for 35 degrees applies which is 60%, so the actual cooling achieved was higher.</p>
<p>See <code>04_Environment_and_development_Stomata_3.py</code> However in reality stomatal aperture does not depend on external temperature but on leaf temperature, so let’s make leaf temperature a variable that affects stomatal aperture and is affected by it. However, we also reduced the stomatal effects on temperature a bit to avoid weird effects: if internal leaf temperature drops too much instead of external temperature 25 being optimal and 35 far below it, we get internal temperatures 17.5 far from optimum and 25 close to optimum, so now under 35 degrees the plants would be doing better. If we make the stomata effect on leaf cooling less strong (factor 0.175 instead of 0.29) internal temperatures are 29 and 20, things are again worse for external temperature of 35, and now for hyponasty situation is only slightly worse and if external temperature is 37.5 with hyponasty plants even perform better. We can further enhance this by boosting angle effect on temperature a bit (factor 0.4 instead of 0.3). If we now additionally assume that stomatal aperture as a function of temperature is usually plotted for external not internal temperature and therefore assume that an external temperature optimum of 24 is approximately an internal leaf temperature of 22 we get a break even for hyponasty at slightly below 35 degrees and plants with hyponasty do actually a bit better at 35 degrees.</p>
<p>As optima are around 25 and stomata always provide some cooling actual growth optimum for angle of 20 degrees is around 28.5 degrees and things only really start to go down at 35 degrees, so there is where the big costs are and where hyponasty earns you more by cooling than it costs in terms of effective leaf area. This explains why if you increase further effect of angle at lowering temperature (eg factor 0.8 instead of 0.4), plants do much better at 36/37 degrees than without hyponasty (i.e.&nbsp;at 36/37 degrees difference gets way bigger), but temperature at which plants with hyponasty start to do better hardly shifts. If optimum temperature of stomatal aperture is lowered than temperature at which plant with hyponasty do better becomes lower.</p>
<p>Also note it is a bit of a flywheel effect, angle brings more cooling, more cooling brings more stomatal aperture, which brings still more cooling.</p>
</blockquote>
</section>
<section id="references" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="references"><span class="header-section-number">11.3</span> References</h2>
<p>Look at this: hyponasty angle quite high during night, dips early in the day <span class="citation" data-cites="praat2024using">Praat et al. (<a href="references.html#ref-praat2024using" role="doc-biblioref">2024</a>)</span></p>
<p>Normal and shade avoidance hyponasty is still large in the dark, and dips around dawn for long day conditions: <span class="citation" data-cites="michaud2017local">Michaud et al. (<a href="references.html#ref-michaud2017local" role="doc-biblioref">2017</a>)</span></p>
<p>For short day conditions it even peaks during the dark and is lower during day: <span class="citation" data-cites="oskam2023low">Oskam et al. (<a href="references.html#ref-oskam2023low" role="doc-biblioref">2023</a>)</span> and <span class="citation" data-cites="dornbusch2012measuring">Dornbusch et al. (<a href="references.html#ref-dornbusch2012measuring" role="doc-biblioref">2012</a>)</span></p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-dornbusch2012measuring" class="csl-entry" role="listitem">
Dornbusch, Tino, Séverine Lorrain, Dmitry Kuznetsov, Arnaud Fortier, Robin Liechti, Ioannis Xenarios, and Christian Fankhauser. 2012. <span>“Measuring the Diurnal Pattern of Leaf Hyponasty and Growth in Arabidopsis–a Novel Phenotyping Approach Using Laser Scanning.”</span> <em>Functional Plant Biology</em> 39 (11): 860–69.
</div>
<div id="ref-michaud2017local" class="csl-entry" role="listitem">
Michaud, Olivier, Anne-Sophie Fiorucci, Ioannis Xenarios, and Christian Fankhauser. 2017. <span>“Local Auxin Production Underlies a Spatially Restricted Neighbor-Detection Response in Arabidopsis.”</span> <em>Proceedings of the National Academy of Sciences</em> 114 (28): 7444–49.
</div>
<div id="ref-oskam2023low" class="csl-entry" role="listitem">
Oskam, Lisa, Basten L Snoek, Chrysoula K Pantazopoulou, Hans van Veen, Sanne EA Matton, Rens Dijkhuizen, and Ronald Pierik. 2023. <span>“A Low-Cost and Open-Source Imaging Platform Reveals Spatiotemporal Insight into Arabidopsis Leaf Elongation and Movement.”</span> <em>BioRxiv</em>, 2023–08.
</div>
<div id="ref-praat2024using" class="csl-entry" role="listitem">
Praat, Myrthe, Zhang Jiang, Joe Earle, Sjef Smeekens, and Martijn van Zanten. 2024. <span>“Using a Thermal Gradient Table to Study Plant Temperature Signalling and Response Across a Temperature Spectrum.”</span> <em>Plant Methods</em> 20 (1): 114.
</div>
<div id="ref-seki2017adjustment" class="csl-entry" role="listitem">
Seki, Motohide, Takayuki Ohara, Timothy J Hearn, Alexander Frank, Viviane CH Da Silva, Camila Caldana, Alex AR Webb, and Akiko Satake. 2017. <span>“Adjustment of the Arabidopsis Circadian Oscillator by Sugar Signalling Dictates the Regulation of Starch Metabolism.”</span> <em>Scientific Reports</em> 7 (1): 8305.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./evdev_intro_text.html" class="pagination-link" aria-label="Environmental inputs">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Environmental inputs</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./evo_intro_text.html" class="pagination-link" aria-label="Introduction to evolution">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to evolution</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Theoretical Biology, Utrecht University.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was made with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"loop":false,"descPosition":"bottom","selector":".lightbox","closeEffect":"zoom","openEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>